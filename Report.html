<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Team: Charline Gu (jg4891), Yaxuan Deng (yd2810), Yuanyuan Zhang (yz4982), Wen Li (wl3013)" />


<title>Project Report</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Welcome To Our Project for P8105!</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="proposal.html">Proposal</a>
</li>
<li>
  <a href="project.html">Code &amp; Results</a>
</li>
<li>
  <a href="Report.html">Report</a>
</li>
<li>
  <a href="team.html">Team</a>
</li>
<li>
  <a href="https://github.com/wl-85/Final_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Project Report</h1>
<h4 class="author">Team: Charline Gu (jg4891), Yaxuan Deng (yd2810),
Yuanyuan Zhang (yz4982), Wen Li (wl3013)</h4>

</div>


<style>
h4.author {
  font-size: 12px;
  font-weight: 400;
  color: #777777;
}
</style>
<hr />
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>In 2023, healthcare spending in the United States accounted for 17.6%
of the national GDP, totaling approximately $4.9 trillion. Despite this
immense expenditure, millions of Americans continue to struggle with
chronic diseases, and healthcare delivery remains highly fragmented.
This inefficiency not only strains the system financially but also
results in poorer outcomes for those who need care the most. One of the
central challenges is the “hot spotters” problem—a small subset of
patients who incur the highest costs often receive the least coordinated
and least effective care. Understanding who these patients are, what
conditions they have, and how their costs evolve over time is critical
for developing targeted interventions that improve health outcomes while
reducing unnecessary spending. Motivated by these challenges, this
project aims to analyze the relationship between healthcare costs and
medical conditions to uncover patterns among high-cost patients. By
identifying key demographic and clinical characteristics associated with
elevated healthcare spending, we aim to inform strategies for more
effective resource allocation and more integrated models of care.</p>
<hr />
</div>
<div id="related-work" class="section level2">
<h2>Related Work</h2>
<p>Our project is largely inspired by <a
href="https://meps.ahrq.gov/data_files/publications/st546/stat546.shtml">Mitchell’s
MEPS Statistical Brief</a>. Following this brief provides us with a
well-established methodological framework for defining high-expenditure
groups, characterizing their demographic and clinical profiles, and
decomposing spending by service type and payer. By using this approach,
we ensure that our analysis is methodologically sound, comparable to
prior work, and capable of producing interpretable population-level
insights. In addition, we draw on tools and techniques introduced in
class, particularly for interactive visualization. Our interactive
dashboard is implemented using R Shiny dashboard, which allows users to
explore expenditure groups, demographics, and condition categories in a
more intuitive and accessible way.</p>
<hr />
</div>
<div id="initial-question" class="section level2">
<h2>Initial Question</h2>
<p>We initially aimed to answer the following key questions:</p>
<ol style="list-style-type: decimal">
<li><p>Who are the patients that incur the highest healthcare
expenditures in 2023 (top 1%, top 5%, top 10%) within the U.S. as
captured by MEPS?</p></li>
<li><p>What demographic and socioeconomic characteristics are associated
with being high-cost?</p></li>
<li><p>Using CCSR classification, what is the role of multimorbidity and
major chronic conditions in predicting whether someone is
high-cost?</p></li>
</ol>
<p>During the process of analysis, our questions became more concrete.
For example, we extend from descriptive to predictive framing, exploring
how well we can predict whether a person is high-cost using
demographics, income/poverty, insurance, and multimorbidity. In
addition, while generating descriptive statistics, we realized that many
patterns were more easily understood when visualized interactively. This
led us to develop a <strong>Shiny dashboard</strong>, allowing users
to:</p>
<ul>
<li>select age group, insurance, and sex</li>
<li>dynamically view expenditure distributions</li>
<li>compare demographic subgroups and explore how spending varies across
key characteristics</li>
</ul>
<p>Throughout the modeling and exploratory analysis process, several
deeper questions arose. We started to think about what is the practical
value of the predictive model. Even if certain variables statistically
improve prediction of high-cost status, does the model improve enough to
matter for policy or care management? Our cross-validated RMSE
comparison across baseline, full, and selected models pushed us to
reflect on whether the added complexity yields meaningful practical
improvement. But since the prevalence of <code>high-cost</code> is too
low and noises exist, how to make such predictions practically
meaningful remains an open question.</p>
<p>Together, these new questions extend our original motivation of
understanding “who” the high-cost patients are toward how we might use
routinely available information (demographics, income, insurance,
diagnoses) to identify and prioritize them for targeted
interventions.</p>
<hr />
</div>
<div id="data-sources-and-access" class="section level2">
<h2>Data sources and access</h2>
<p>Our analysis uses publicly available data from the Medical
Expenditure Panel Survey (MEPS), conducted by the Agency for Healthcare
Research and Quality (AHRQ). Specifically, we draw on two 2023
public-use files:</p>
<ul>
<li><p><strong>2023 Full-Year Consolidated Data File
(HC-251)</strong><br />
This file provides person-level information on annual health care
expenditures, demographics, insurance coverage, and survey design
variables for the U.S. civilian noninstitutionalized
population.</p></li>
<li><p><strong>2023 Medical Conditions File (HC-249)</strong><br />
This file contains encounter-level information on medical conditions
reported during MEPS interviews, including condition identifiers and
Clinical Classifications Software Refined (CCSR) codes.</p></li>
</ul>
<p>Both files were downloaded from the MEPS website as standardized
<code>.ssp</code> files. We imported them into R using the
<code>MEPS</code> R package and the <code>read_MEPS()</code> function,
which implements the recommended MEPS data-reading workflow and
preserves variable formats. For convenience in downstream analysis, we
converted all variable names to lowercase immediately after import.</p>
<p><br></p>
<div id="unit-of-analysis-and-key-variables" class="section level3">
<h3>Unit of analysis and key variables</h3>
<p>The primary unit of analysis in this project is the
<strong>individual (person)</strong>. From the full-year consolidated
file (HC-251), we retain:</p>
<ul>
<li><strong>Survey design variables</strong>
<ul>
<li><code>varstr</code>, <code>varpsu</code>: variance strata and
primary sampling unit identifiers<br />
</li>
<li><code>perwt23f</code>: person-level survey weight</li>
</ul></li>
<li><strong>Expenditure variable</strong>
<ul>
<li><code>totexp23</code>: total health care expenditures in 2023,
summing all payments from all payers and service types at the person
level</li>
</ul></li>
<li><strong>Core demographic and socioeconomic variables</strong>
<ul>
<li><code>agelast</code>: age at the end of 2023<br />
</li>
<li><code>sex</code>: sex (1 = male, 2 = female)<br />
</li>
<li><code>racethx</code>: detailed race/ethnicity categories<br />
</li>
<li><code>povcat23</code>: family income relative to the federal poverty
line (1–5)<br />
</li>
<li><code>inscov23</code>: insurance coverage category (1 = any private,
2 = public only, 3 = uninsured)</li>
</ul></li>
</ul>
<p>From the conditions file (HC-249), we retain:</p>
<ul>
<li><strong>Linkage and survey design variables:</strong>
<code>dupersid</code>, <code>condidx</code>, <code>varstr</code>,
<code>varpsu</code>, <code>perwt23f</code><br />
</li>
<li><strong>Condition classification:</strong> CCSR codes
(<code>ccsr1x</code>–<code>ccsr4x</code>), which we later collapse to a
single primary condition code per record.</li>
</ul>
<p>These variables form the basis for defining high-cost groups,
describing population characteristics, and identifying the most commonly
treated conditions among high-expenditure patients.</p>
<p><br></p>
</div>
<div id="cleaning-and-preparation-of-the-person-level-file-hc-251"
class="section level3">
<h3>Cleaning and preparation of the person-level file (HC-251)</h3>
<p>We begin by creating a working copy of the full-year consolidated
file and applying several cleaning steps:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Restriction to positive weights</strong><br />
MEPS uses person-level weights to represent the target population. We
restrict the analytic dataset to records with
<code>perwt23f &gt; 0</code>, which excludes ineligible or unweighted
respondents and ensures that weighted estimates correspond to the 2023
U.S. civilian noninstitutionalized population.</p></li>
<li><p><strong>Standardizing missing values</strong><br />
MEPS encodes various types of missing or inapplicable responses using
negative numeric codes (e.g., -1, -7, -8, -9, -15). To avoid treating
these codes as valid values in summaries or models, we loop over all
numeric variables and recode these negative codes to <code>NA</code>.
This harmonized missing-value convention allows base R and
<code>survey</code> functions to automatically exclude missing
observations when computing estimates.</p></li>
<li><p><strong>Variable selection</strong><br />
To keep the working dataset focused and efficient, we subset to a
minimal set of variables required for our analyses: the person
identifier (<code>dupersid</code>), survey design variables,
<code>totexp23</code>, and the demographic and socioeconomic variables
listed above. This curated dataset (<code>fyc23_clean</code>) is used to
construct the survey design object and all subsequent person-level
analyses.</p></li>
<li><p><strong>Re-defining the survey design</strong><br />
After cleaning and subsetting, we reconstruct a survey design object
using the <code>survey</code> package, specifying:</p>
<ul>
<li>clustering by <code>varpsu</code><br />
</li>
<li>stratification by <code>varstr</code><br />
</li>
<li>weighting by <code>perwt23f</code><br />
</li>
<li><code>nest = TRUE</code> to correctly reflect the multi-stage
design</li>
</ul>
<p>All weighted estimates in the project—such as proportions, means, and
quantiles—are computed under this survey design.</p></li>
</ol>
<p><br></p>
</div>
<div id="construction-of-demographic-and-socioeconomic-categories"
class="section level3">
<h3>Construction of demographic and socioeconomic categories</h3>
<p>For descriptive and stratified analyses, we recode several MEPS
variables into interpretable categorical factors:</p>
<ul>
<li><p><strong>Age groups (<code>age_cat4</code>)</strong><br />
We categorize <code>agelast</code> into four life-stage groups commonly
used in health services research:</p>
<ul>
<li>0–17 years<br />
</li>
<li>18–44 years<br />
</li>
<li>45–64 years<br />
</li>
<li>65 years and older</li>
</ul>
<p>The factor is explicitly ordered from youngest to oldest to
facilitate interpretation of age patterns.</p></li>
<li><p><strong>Sex (<code>sex_f</code>)</strong><br />
We recode <code>sex</code> into a labeled factor with levels
<strong>“Male”</strong> and <strong>“Female”</strong>, matching the
original coding (1 and 2, respectively).</p></li>
<li><p><strong>Race/ethnicity (<code>race4</code>)</strong><br />
Using <code>racethx</code>, we construct a four-category race/ethnicity
variable:</p>
<ul>
<li>Hispanic<br />
</li>
<li>Non-Hispanic White (NH White)<br />
</li>
<li>Non-Hispanic Black (NH Black)<br />
</li>
<li>Non-Hispanic Asian/Other (NH Asian/Other), combining smaller
non-White, non-Black race categories to improve stability of
estimates</li>
</ul>
<p>The reference level is set to NH White, which is consistent with many
MEPS reports and facilitates interpretation of racial/ethnic
comparisons.</p></li>
<li><p><strong>Income relative to poverty
(<code>povcat_f</code>)</strong><br />
<code>povcat23</code> (1–5) is recoded into labeled categories:</p>
<ul>
<li>Poor<br />
</li>
<li>Near-poor<br />
</li>
<li>Low income<br />
</li>
<li>Middle income<br />
</li>
<li>High income</li>
</ul>
<p>Note that “High income” in MEPS corresponds to family income ≥ 4
times the federal poverty line; this group primarily represents
middle-class and above rather than the extremely wealthy.</p></li>
<li><p><strong>Insurance coverage (<code>inscov_f</code>)</strong><br />
We recode <code>inscov23</code> into:</p>
<ul>
<li>Any private insurance<br />
</li>
<li>Public insurance only<br />
</li>
<li>Uninsured</li>
</ul></li>
</ul>
<p>After creating these factors, we reconstruct the survey design object
so that all downstream analyses use the updated categorical
variables.</p>
<p><br></p>
</div>
<div id="defining-expenditure-groups-top-1-top-5-top-10-bottom-50"
class="section level3">
<h3>Defining expenditure groups (Top 1%, Top 5%, Top 10%, Bottom
50%)</h3>
<p>Following the approach in the MEPS Statistical Brief on the
concentration of healthcare expenditures, we use survey-weighted
quantiles of <code>totexp23</code> to define mutually exclusive
expenditure groups:</p>
<ul>
<li>Using <code>svyquantile()</code> under our survey design, we compute
the weighted:
<ul>
<li>50th percentile (median)<br />
</li>
<li>90th percentile<br />
</li>
<li>95th percentile<br />
</li>
<li>99th percentile</li>
</ul></li>
</ul>
<p>Letting these cutpoints be <span
class="math inline">\(p_{50}\)</span>, <span
class="math inline">\(p_{90}\)</span>, <span
class="math inline">\(p_{95}\)</span>, and <span
class="math inline">\(p_{99}\)</span>, we create a categorical variable
<code>exp_group</code>:</p>
<ul>
<li><strong>Top 1%</strong>: <code>totexp23 ≥ p99</code><br />
</li>
<li><strong>Top 5%</strong>: <code>p95 ≤ totexp23 &lt; p99</code><br />
</li>
<li><strong>Top 10%</strong>: <code>p90 ≤ totexp23 &lt; p95</code><br />
</li>
<li><strong>Bottom 50%</strong>: <code>totexp23 ≤ p50</code><br />
</li>
<li><strong>50–90%</strong>: all remaining individuals with expenditures
between the median and the 90th percentile</li>
</ul>
<p>The factor is ordered as: Bottom 50%, 50–90%, Top 10%, Top 5%, Top
1%. This structure allows us to align our results with prior MEPS briefs
and to focus particularly on the small subset of “high-cost” patients in
the Top 1% and Top 5%.</p>
<p>We then reconstruct the survey design once more using
<code>fyc23_clean</code> with <code>exp_group</code> included, enabling
direct computation of weighted distributions of demographic and clinical
characteristics within each expenditure group.</p>
<p><br></p>
</div>
<div id="cleaning-and-preparation-of-the-conditions-file-hc-249"
class="section level3">
<h3>Cleaning and preparation of the conditions file (HC-249)</h3>
<p>To study the clinical profile of high-cost patients, we process the
2023 Medical Conditions file as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Standardizing missing values</strong><br />
As in the person file, we convert negative numeric codes (e.g., -1, -7,
-8, -9, -15) to <code>NA</code> across all numeric variables. For the
CCSR code variables (<code>ccsr1x</code>–<code>ccsr4x</code>), which are
stored as character strings, we replace sentinel values such as
<code>"-1"</code> and <code>"-15"</code> with <code>NA</code>.</p></li>
<li><p><strong>Defining a primary CCSR code
(<code>ccsr_main</code>)</strong><br />
Each condition record may have up to four CCSR codes. To simplify
analysis and ensure that each record is assigned a single primary
condition category, we construct <code>ccsr_main</code> using a
hierarchical rule:</p>
<ul>
<li>Start with <code>ccsr1x</code><br />
</li>
<li>If <code>ccsr1x</code> is missing, use <code>ccsr2x</code><br />
</li>
<li>If still missing, fall back to <code>ccsr3x</code>, and then
<code>ccsr4x</code> if necessary</li>
</ul>
<p>We drop records for which all four CCSR codes are missing so that the
conditions dataset only includes observations with a valid clinical
classification.</p></li>
<li><p><strong>Variable selection</strong><br />
We retain only variables needed for linkage and weighting in later
analyses:</p>
<ul>
<li><code>dupersid</code> (person identifier) and <code>condidx</code>
(condition identifier)<br />
</li>
<li><code>varstr</code>, <code>varpsu</code>,
<code>perwt23f</code><br />
</li>
<li><code>ccsr_main</code></li>
</ul>
<p>This cleaned conditions dataset (<code>cond23_clean</code>) can be
merged with the person-level dataset by <code>dupersid</code>, allowing
us to describe the most common CCSR categories among individuals in the
Top 1%, Top 5%, and other expenditure groups.</p></li>
</ol>
<p><br></p>
</div>
<div id="quality-checks" class="section level3">
<h3>Quality checks</h3>
<p>To verify the integrity of our cleaned data and survey design, we
conduct several diagnostic checks:</p>
<ul>
<li>We confirm that the sum of survey weights in the person-level design
is on the order of the U.S. population and that the weighted totals by
age group, race/ethnicity, poverty category, and insurance status
closely match the overall total (up to small rounding
differences).<br />
</li>
<li>We inspect cross-tabulations between original MEPS codes and our
recoded factors (e.g., <code>racethx</code> vs. <code>race4</code>,
<code>povcat23</code> vs. <code>povcat_f</code>, <code>inscov23</code>
vs. <code>inscov_f</code>) to ensure that category mappings are
correct.<br />
</li>
<li>We compute weighted frequencies and proportions for
<code>exp_group</code> to confirm that the quantile-based cutpoints
produce reasonable shares of the population in each expenditure
category.</li>
</ul>
<p>These steps provide confidence that our analytic datasets accurately
reflect the intended MEPS design and that our derived variables are
correctly constructed. All data cleaning and processing is implemented
in R and is fully reproducible in the project code.</p>
</div>
<div id="data-cleaning-code" class="section level3">
<h3>Data cleaning code</h3>
<p><em>The full, reproducible code used to implement the cleaning steps
described above is provided below. Readers who are primarily interested
in results may skip this section.</em></p>
<details>
<summary>
<strong> Click to show / hide full data cleaning and preparation
code</strong>
</summary>
<p><br></p>
<pre class="r"><code># Load in packages
library(devtools)
library(tidyverse)
library(readr)
library(readxl)
library(haven)
library(survey)
library(MEPS)
library(knitr)

# Read &quot;2023 MEPS&quot; data
# 2023 Full-Year Consolidated（HC-251）
## Personnel expenses + Demographics + Sampling design variables
fyc23  &lt;- read_MEPS(file = &quot;h251&quot;)
cond23 &lt;- read_MEPS(file = &quot;h249&quot;)

## Read &quot;2023 Medical Conditions&quot; data（HC-249）
## Diseases / CCSR
names(fyc23)  &lt;- tolower(names(fyc23))
names(cond23) &lt;- tolower(names(cond23))

des23 &lt;- svydesign(
  ids    = ~varpsu,
  strata = ~varstr,
  weights= ~perwt23f,
  data   = fyc23,
  nest   = TRUE
)

# This chunk only need to run in &quot;Console&quot; once, do not run when knitting the file
# devtools::install_github(&quot;e-mitchell/meps_r_pkg/MEPS&quot;)
# library(MEPS)

# Quick check of the total fee variable (totexp23)
summary(fyc23$totexp23)</code></pre>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##      0.0    299.5   1816.0   8422.0   7087.0 574675.0</code></pre>
<pre class="r"><code>names(fyc23)[1:30]</code></pre>
<pre><code>##  [1] &quot;duid&quot;     &quot;pid&quot;      &quot;dupersid&quot; &quot;panel&quot;    &quot;datayear&quot; &quot;famid31&quot; 
##  [7] &quot;famid42&quot;  &quot;famid53&quot;  &quot;famid23&quot;  &quot;famidyr&quot;  &quot;cpsfamid&quot; &quot;fcsz1231&quot;
## [13] &quot;fcrp1231&quot; &quot;ruletr31&quot; &quot;ruletr42&quot; &quot;ruletr53&quot; &quot;ruletr23&quot; &quot;rusize31&quot;
## [19] &quot;rusize42&quot; &quot;rusize53&quot; &quot;rusize23&quot; &quot;ruclas31&quot; &quot;ruclas42&quot; &quot;ruclas53&quot;
## [25] &quot;ruclas23&quot; &quot;famsze31&quot; &quot;famsze42&quot; &quot;famsze53&quot; &quot;famsze23&quot; &quot;fmrs1231&quot;</code></pre>
<pre class="r"><code>grep(&quot;23&quot;, names(fyc23), value = TRUE)[1:20]</code></pre>
<pre><code>##  [1] &quot;famid23&quot;  &quot;fcsz1231&quot; &quot;fcrp1231&quot; &quot;ruletr23&quot; &quot;rusize23&quot; &quot;ruclas23&quot;
##  [7] &quot;famsze23&quot; &quot;fmrs1231&quot; &quot;fams1231&quot; &quot;region23&quot; &quot;refprs23&quot; &quot;resp23&quot;  
## [13] &quot;proxy23&quot;  &quot;endrfm23&quot; &quot;endrfy23&quot; &quot;inscop23&quot; &quot;insc1231&quot; &quot;elgrnd23&quot;
## [19] &quot;age23x&quot;   &quot;marry23x&quot;</code></pre>
<pre class="r"><code>nrow(fyc23) </code></pre>
<pre><code>## [1] 18919</code></pre>
<pre class="r"><code>## data clean
fyc23_clean &lt;- fyc23

# Only keep the individuals with positive weight
fyc23_clean &lt;- fyc23_clean[fyc23_clean$perwt23f &gt; 0, ]

# Change all the missing value (-1, -7, -8, -9, -15) into NA
num_vars &lt;- sapply(fyc23_clean, is.numeric)

for (j in which(num_vars)) {
  x &lt;- fyc23_clean[[j]]
  x[x %in% c(-1, -7, -8, -9, -15)] &lt;- NA
  fyc23_clean[[j]] &lt;- x
}

# Only keep the variables needed for this project (could extend later)
keep_vars &lt;- c(
  &quot;dupersid&quot;, &quot;panel&quot;, &quot;varstr&quot;, &quot;varpsu&quot;, &quot;perwt23f&quot;,
  &quot;totexp23&quot;,
  &quot;agelast&quot;, &quot;sex&quot;, &quot;racethx&quot;,
  &quot;povcat23&quot;, &quot;inscov23&quot;
)

fyc23_clean &lt;- fyc23_clean[ , keep_vars]

# Use cleaned data to rebuild &quot;survey design&quot;
des23 &lt;- svydesign(
  ids    = ~varpsu,
  strata = ~varstr,
  weights= ~perwt23f,
  data   = fyc23_clean,
  nest   = TRUE
)

## Demographic variables

# 2.1 Build blank variable columns
fyc23_clean$age_cat4  &lt;- NA
fyc23_clean$sex_f     &lt;- NA
fyc23_clean$race4     &lt;- NA
fyc23_clean$povcat_f  &lt;- NA
fyc23_clean$inscov_f  &lt;- NA

# 2.2 Age groups：0–17, 18–44, 45–64, 65+
fyc23_clean$age_cat4[fyc23_clean$agelast &lt;= 17] &lt;- &quot;0-17&quot;
fyc23_clean$age_cat4[fyc23_clean$agelast &gt;= 18 &amp; fyc23_clean$agelast &lt;= 44] &lt;- &quot;18-44&quot;
fyc23_clean$age_cat4[fyc23_clean$agelast &gt;= 45 &amp; fyc23_clean$agelast &lt;= 64] &lt;- &quot;45-64&quot;
fyc23_clean$age_cat4[fyc23_clean$agelast &gt;= 65] &lt;- &quot;65+&quot;

fyc23_clean$age_cat4 &lt;- factor(
  fyc23_clean$age_cat4,
  levels = c(&quot;0-17&quot;, &quot;18-44&quot;, &quot;45-64&quot;, &quot;65+&quot;)
)

# 2.3 Gender: 1=Male, 2=Female
fyc23_clean$sex_f[fyc23_clean$sex == 1] &lt;- &quot;Male&quot;
fyc23_clean$sex_f[fyc23_clean$sex == 2] &lt;- &quot;Female&quot;
fyc23_clean$sex_f &lt;- factor(
  fyc23_clean$sex_f,
  levels = c(&quot;Male&quot;, &quot;Female&quot;)
)

# 2.4 Race: NH White, NH Black, Hispanic, NH Asian/Other
fyc23_clean$race4[fyc23_clean$racethx == 1] &lt;- &quot;Hispanic&quot;
fyc23_clean$race4[fyc23_clean$racethx == 2] &lt;- &quot;NH White&quot;
fyc23_clean$race4[fyc23_clean$racethx == 3] &lt;- &quot;NH Black&quot;
fyc23_clean$race4[fyc23_clean$racethx %in% c(4, 5)] &lt;- &quot;NH Asian/Other&quot;

fyc23_clean$race4 &lt;- factor(
  fyc23_clean$race4,
  levels = c(&quot;NH White&quot;, &quot;NH Black&quot;, &quot;Hispanic&quot;, &quot;NH Asian/Other&quot;)
)

# 2.5 Poverty line groups (POVCAT23): 1–5
pov_labels &lt;- c(
  &quot;Poor&quot;, &quot;Near-poor&quot;, &quot;Low income&quot;,
  &quot;Middle income&quot;, &quot;High income&quot;
)

fyc23_clean$povcat_f &lt;- factor(
  fyc23_clean$povcat23,
  levels = 1:5,
  labels = pov_labels
)

# 2.6 Insurance type (INSCOV23): 1 any private, 2 public only, 3 uninsured
ins_labels &lt;- c(&quot;Any private&quot;, &quot;Public only&quot;, &quot;Uninsured&quot;)

fyc23_clean$inscov_f &lt;- factor(
  fyc23_clean$inscov23,
  levels = 1:3,
  labels = ins_labels
)

# 2.7 Use updated data to rebuild &quot;design&quot;
des23 &lt;- svydesign(
  ids    = ~varpsu,
  strata = ~varstr,
  weights= ~perwt23f,
  data   = fyc23_clean,
  nest   = TRUE
)

# Quick checks
svytable(~ age_cat4, des23)</code></pre>
<pre><code>## age_cat4
##      0-17     18-44     45-64       65+ 
##  72310868 118897360  81736013  61586033</code></pre>
<pre class="r"><code>svytable(~ race4, des23)</code></pre>
<pre><code>## race4
##       NH White       NH Black       Hispanic NH Asian/Other 
##      191904354       41881236       65759049       34985634</code></pre>
<pre class="r"><code>svytable(~ povcat_f, des23)</code></pre>
<pre><code>## povcat_f
##          Poor     Near-poor    Low income Middle income   High income 
##      37085125      12759876      40476857      96119086     148089329</code></pre>
<pre class="r"><code>svytable(~ inscov_f, des23)</code></pre>
<pre><code>## inscov_f
## Any private Public only   Uninsured 
##   215911541    97419962    21198770</code></pre>
<pre class="r"><code>table(fyc23_clean$age_cat4, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>## 
##  0-17 18-44 45-64   65+ 
##  3556  5543  4756  4608</code></pre>
<pre class="r"><code>tapply(
  fyc23_clean$agelast,
  fyc23_clean$age_cat4,
  function(x) range(x, na.rm = TRUE)
)</code></pre>
<pre><code>## $`0-17`
## [1]  0 17
## 
## $`18-44`
## [1] 18 44
## 
## $`45-64`
## [1] 45 64
## 
## $`65+`
## [1] 65 85</code></pre>
<pre class="r"><code>table(fyc23_clean$racethx, fyc23_clean$race4, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>##    
##     NH White NH Black Hispanic NH Asian/Other
##   1        0        0     4087              0
##   2    10112        0        0              0
##   3        0     2448        0              0
##   4        0        0        0           1133
##   5        0        0        0            683</code></pre>
<pre class="r"><code>table(fyc23_clean$povcat23, fyc23_clean$povcat_f, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>##    
##     Poor Near-poor Low income Middle income High income
##   1 2803         0          0             0           0
##   2    0       868          0             0           0
##   3    0         0       2421             0           0
##   4    0         0          0          5145           0
##   5    0         0          0             0        7226</code></pre>
<pre class="r"><code>table(fyc23_clean$inscov23, fyc23_clean$inscov_f, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>##    
##     Any private Public only Uninsured
##   1       10833           0         0
##   2           0        6431         0
##   3           0           0      1199</code></pre>
<pre class="r"><code># Define Top 1%、Top 5%、Top 10%、Bottom 50%
exp_cuts &lt;- svyquantile(
  ~ totexp23,
  design    = des23,
  quantiles = c(0.50, 0.90, 0.95, 0.99),
  ci        = FALSE
)

exp_cuts</code></pre>
<pre><code>## $totexp23
##       0.5   0.9  0.95  0.99
## [1,] 1583 18330 34150 93443
## 
## attr(,&quot;hasci&quot;)
## [1] FALSE
## attr(,&quot;class&quot;)
## [1] &quot;newsvyquantile&quot;</code></pre>
<pre class="r"><code>str(exp_cuts)</code></pre>
<pre><code>## List of 1
##  $ totexp23: num [1, 1:4] 1583 18330 34150 93443
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:4] &quot;0.5&quot; &quot;0.9&quot; &quot;0.95&quot; &quot;0.99&quot;
##  - attr(*, &quot;hasci&quot;)= logi FALSE
##  - attr(*, &quot;class&quot;)= chr &quot;newsvyquantile&quot;</code></pre>
<pre class="r"><code>q_vec &lt;- as.numeric(exp_cuts$totexp23)
p50 &lt;- q_vec[1]
p90 &lt;- q_vec[2]
p95 &lt;- q_vec[3]
p99 &lt;- q_vec[4]

fyc23_clean$exp_group &lt;- NA
fyc23_clean$exp_group[fyc23_clean$totexp23 &gt;= p99] &lt;- &quot;Top 1%&quot;
fyc23_clean$exp_group[fyc23_clean$totexp23 &gt;= p95 &amp; fyc23_clean$totexp23 &lt; p99] &lt;- &quot;Top 5%&quot;
fyc23_clean$exp_group[fyc23_clean$totexp23 &gt;= p90 &amp; fyc23_clean$totexp23 &lt; p95] &lt;- &quot;Top 10%&quot;
fyc23_clean$exp_group[fyc23_clean$totexp23 &lt;= p50] &lt;- &quot;Bottom 50%&quot;

fyc23_clean$exp_group[
  is.na(fyc23_clean$exp_group) &amp; !is.na(fyc23_clean$totexp23)
] &lt;- &quot;50–90%&quot;

fyc23_clean$exp_group &lt;- factor(
  fyc23_clean$exp_group,
  levels = c(&quot;Bottom 50%&quot;, &quot;50–90%&quot;, &quot;Top 10%&quot;, &quot;Top 5%&quot;, &quot;Top 1%&quot;)
)

des23 &lt;- svydesign(
  ids    = ~varpsu,
  strata = ~varstr,
  weights= ~perwt23f,
  data   = fyc23_clean,
  nest   = TRUE
)

svytable(~ exp_group, des23)</code></pre>
<pre><code>## exp_group
## Bottom 50%     50–90%    Top 10%     Top 5%     Top 1% 
##  167271763  133802060   16720928   13369123    3366399</code></pre>
<pre class="r"><code>svytable(~ exp_group, des23) / sum(weights(des23))</code></pre>
<pre><code>## exp_group
## Bottom 50%     50–90%    Top 10%     Top 5%     Top 1% 
## 0.50001981 0.39996996 0.04998330 0.03996387 0.01006306</code></pre>
<pre class="r"><code># Handle the data of &quot;cond23&quot;
cond23_clean &lt;- cond23

num_vars_c &lt;- sapply(cond23_clean, is.numeric)
for (j in which(num_vars_c)) {
  x &lt;- cond23_clean[[j]]
  x[x %in% c(-1, -7, -8, -9, -15)] &lt;- NA
  cond23_clean[[j]] &lt;- x
}

ccsr_cols &lt;- grep(&quot;^ccsr&quot;, names(cond23_clean), value = TRUE)
for (nm in ccsr_cols) {
  x &lt;- cond23_clean[[nm]]
  x[x %in% c(&quot;-1&quot;, &quot;-15&quot;)] &lt;- NA
  cond23_clean[[nm]] &lt;- x
}

cond23_clean$ccsr_main &lt;- cond23_clean$ccsr1x
idx_na &lt;- is.na(cond23_clean$ccsr_main) &amp; !is.na(cond23_clean$ccsr2x)
cond23_clean$ccsr_main[idx_na] &lt;- cond23_clean$ccsr2x[idx_na]
idx_na &lt;- is.na(cond23_clean$ccsr_main) &amp; !is.na(cond23_clean$ccsr3x)
cond23_clean$ccsr_main[idx_na] &lt;- cond23_clean$ccsr3x[idx_na]
idx_na &lt;- is.na(cond23_clean$ccsr_main) &amp; !is.na(cond23_clean$ccsr4x)
cond23_clean$ccsr_main[idx_na] &lt;- cond23_clean$ccsr4x[idx_na]

cond23_clean &lt;- cond23_clean[!is.na(cond23_clean$ccsr_main), ]

keep_cond_vars &lt;- c(
  &quot;dupersid&quot;, &quot;condidx&quot;,
  &quot;varstr&quot;, &quot;varpsu&quot;, &quot;perwt23f&quot;,
  &quot;ccsr_main&quot;
)
cond23_clean &lt;- cond23_clean[ , keep_cond_vars]

head(sort(table(cond23_clean$ccsr_main), decreasing = TRUE), 10)</code></pre>
<pre><code>## 
## CIR007 END010 MUS010 END002 MBD005 MBD002 END001 MUS006 DIG004 RSP009 
##   4312   3626   2557   1960   1791   1557   1346   1345   1245   1212</code></pre>
<pre class="r"><code># Double checks
total_pop &lt;- sum(weights(des23))
total_pop</code></pre>
<pre><code>## [1] 334530273</code></pre>
<pre class="r"><code>tab_age   &lt;- svytable(~ age_cat4,  des23)
tab_race  &lt;- svytable(~ race4,     des23)
tab_pov   &lt;- svytable(~ povcat_f,  des23)
tab_ins   &lt;- svytable(~ inscov_f,  des23)

sum_age  &lt;- sum(tab_age)
sum_race &lt;- sum(tab_race)
sum_pov  &lt;- sum(tab_pov)
sum_ins  &lt;- sum(tab_ins)

c(
  total_pop = total_pop,
  sum_age   = sum_age,
  sum_race  = sum_race,
  sum_pov   = sum_pov,
  sum_ins   = sum_ins
)</code></pre>
<pre><code>## total_pop   sum_age  sum_race   sum_pov   sum_ins 
## 334530273 334530273 334530273 334530273 334530273</code></pre>
<pre class="r"><code>c(
  age_minus_total  = sum_age  - total_pop,
  race_minus_total = sum_race - total_pop,
  pov_minus_total  = sum_pov  - total_pop,
  ins_minus_total  = sum_ins  - total_pop
)</code></pre>
<pre><code>##  age_minus_total race_minus_total  pov_minus_total  ins_minus_total 
##                0                0                0                0</code></pre>
<pre class="r"><code>tab_age</code></pre>
<pre><code>## age_cat4
##      0-17     18-44     45-64       65+ 
##  72310868 118897360  81736013  61586033</code></pre>
<pre class="r"><code>prop_age &lt;- prop.table(tab_age)
prop_age</code></pre>
<pre><code>## age_cat4
##      0-17     18-44     45-64       65+ 
## 0.2161564 0.3554158 0.2443307 0.1840970</code></pre>
<pre class="r"><code>sum(prop_age)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>tab_race</code></pre>
<pre><code>## race4
##       NH White       NH Black       Hispanic NH Asian/Other 
##      191904354       41881236       65759049       34985634</code></pre>
<pre class="r"><code>prop_race &lt;- prop.table(tab_race)
prop_race</code></pre>
<pre><code>## race4
##       NH White       NH Black       Hispanic NH Asian/Other 
##      0.5736532      0.1251942      0.1965713      0.1045814</code></pre>
<pre class="r"><code>sum(prop_race)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>tab_pov</code></pre>
<pre><code>## povcat_f
##          Poor     Near-poor    Low income Middle income   High income 
##      37085125      12759876      40476857      96119086     148089329</code></pre>
<pre class="r"><code>prop_pov &lt;- prop.table(tab_pov)
prop_pov</code></pre>
<pre><code>## povcat_f
##          Poor     Near-poor    Low income Middle income   High income 
##    0.11085731    0.03814266    0.12099609    0.28732553    0.44267841</code></pre>
<pre class="r"><code>sum(prop_pov)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>tab_ins</code></pre>
<pre><code>## inscov_f
## Any private Public only   Uninsured 
##   215911541    97419962    21198770</code></pre>
<pre class="r"><code>prop_ins &lt;- prop.table(tab_ins)
prop_ins</code></pre>
<pre><code>## inscov_f
## Any private Public only   Uninsured 
##  0.64541705  0.29121419  0.06336876</code></pre>
<pre class="r"><code>sum(prop_ins)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>table(fyc23_clean$age_cat4, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>## 
##  0-17 18-44 45-64   65+ 
##  3556  5543  4756  4608</code></pre>
<pre class="r"><code>tapply(
  fyc23_clean$agelast,
  fyc23_clean$age_cat4,
  function(x) range(x, na.rm = TRUE)
)</code></pre>
<pre><code>## $`0-17`
## [1]  0 17
## 
## $`18-44`
## [1] 18 44
## 
## $`45-64`
## [1] 45 64
## 
## $`65+`
## [1] 65 85</code></pre>
<pre class="r"><code>table(fyc23_clean$racethx, fyc23_clean$race4, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>##    
##     NH White NH Black Hispanic NH Asian/Other
##   1        0        0     4087              0
##   2    10112        0        0              0
##   3        0     2448        0              0
##   4        0        0        0           1133
##   5        0        0        0            683</code></pre>
<pre class="r"><code>table(fyc23_clean$povcat23, fyc23_clean$povcat_f, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>##    
##     Poor Near-poor Low income Middle income High income
##   1 2803         0          0             0           0
##   2    0       868          0             0           0
##   3    0         0       2421             0           0
##   4    0         0          0          5145           0
##   5    0         0          0             0        7226</code></pre>
<pre class="r"><code>table(fyc23_clean$inscov23, fyc23_clean$inscov_f, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>##    
##     Any private Public only Uninsured
##   1       10833           0         0
##   2           0        6431         0
##   3           0           0      1199</code></pre>
<pre class="r"><code>tab_exp &lt;- svytable(~ exp_group, des23)
tab_exp</code></pre>
<pre><code>## exp_group
## Bottom 50%     50–90%    Top 10%     Top 5%     Top 1% 
##  167271763  133802060   16720928   13369123    3366399</code></pre>
<pre class="r"><code>prop_exp &lt;- prop.table(tab_exp)
prop_exp</code></pre>
<pre><code>## exp_group
## Bottom 50%     50–90%    Top 10%     Top 5%     Top 1% 
## 0.50001981 0.39996996 0.04998330 0.03996387 0.01006306</code></pre>
<pre class="r"><code>sum(prop_exp)</code></pre>
<pre><code>## [1] 1</code></pre>
</details>
<hr />
</div>
</div>
<div id="demographic-information" class="section level2">
<h2>Demographic Information</h2>
<p>From the age distribution table, among 18463 participants, 19% of
individuals age under 17 years old. 30% of participants aged between 18
and 44 years old. About 26% participants age between 45 and 64 years
old. 25% of participants aged above 65 years old.</p>
<table>
<thead>
<tr class="header">
<th align="left">Age Category</th>
<th align="right">n</th>
<th align="right">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0-17</td>
<td align="right">3556</td>
<td align="right">19.3</td>
</tr>
<tr class="even">
<td align="left">18-44</td>
<td align="right">5543</td>
<td align="right">30.0</td>
</tr>
<tr class="odd">
<td align="left">45-64</td>
<td align="right">4756</td>
<td align="right">25.8</td>
</tr>
<tr class="even">
<td align="left">65+</td>
<td align="right">4608</td>
<td align="right">25.0</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">18463</td>
<td align="right">100.0</td>
</tr>
</tbody>
</table>
<p>We can see that 8783 (47.6%) individuals are male and 9680 (52.4%)
individuals are female.</p>
<table>
<thead>
<tr class="header">
<th align="left">Sex</th>
<th align="right">n</th>
<th align="right">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Male</td>
<td align="right">8783</td>
<td align="right">47.6</td>
</tr>
<tr class="even">
<td align="left">Female</td>
<td align="right">9680</td>
<td align="right">52.4</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">18463</td>
<td align="right">100.0</td>
</tr>
</tbody>
</table>
<p>However, from the race distribution table, it seems that the
distribution is not equal among white, black, hispanic, asian, and other
people. 54.8% participants are white. 13% are black. 22.1% are hispanic.
Asians/other only takes up 9.8% of the sample population.</p>
<table>
<thead>
<tr class="header">
<th align="left">Race Category</th>
<th align="right">n</th>
<th align="right">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NH White</td>
<td align="right">10112</td>
<td align="right">54.8</td>
</tr>
<tr class="even">
<td align="left">NH Black</td>
<td align="right">2448</td>
<td align="right">13.3</td>
</tr>
<tr class="odd">
<td align="left">Hispanic</td>
<td align="right">4087</td>
<td align="right">22.1</td>
</tr>
<tr class="even">
<td align="left">NH Asian/Other</td>
<td align="right">1816</td>
<td align="right">9.8</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">18463</td>
<td align="right">100.0</td>
</tr>
</tbody>
</table>
<div id="interactive-dashboard" class="section level3">
<h3>Interactive Dashboard</h3>
<p>We also created an interactive dashboard via rshiny to show the
expenditure for each race or sex. You can zoom in or zoom out by
dragging the parts of plot. We created a violin plot to show total
health expenditure in 2023 by 4 age groups and different races, which is
in different colors. We also created a histogram of number of people in
four income levels, near-poor, poor, low-income, middle-income, and
high-income, grouped by insurance types. In addition, we created a
scatterplot to show the health expenditure in 2023 among different
insurance types, grouped by sex. The interactive dashboard can be
accessed at <a
href="https://jinghg.shinyapps.io/final_projectgithub/">here</a>.</p>
<hr />
</div>
</div>
<div id="additional-analysis" class="section level2">
<h2>Additional Analysis</h2>
<div id="survey-weighted-regression-modeling" class="section level3">
<h3>Survey-Weighted Regression Modeling</h3>
<p>To complement our descriptive analyses, we conducted a series of
survey-weighted logistic regression models to examine factors associated
with being a high-cost individual (defined as the top 5% of total
expenditures based on survey-weighted percentiles).</p>
<p>All models were estimated using the MEPS complex survey design,
incorporating strata, PSUs, and person-level weights.</p>
<p><br></p>
</div>
<div id="model-1-baseline-demographic-and-socioeconomic-predictors"
class="section level3">
<h3>Model 1: Baseline demographic and socioeconomic predictors</h3>
<p>First, we fit an initial model with 6 predictors:</p>
<ul>
<li>age group (<code>age_cat4</code>)</li>
<li>sex (<code>sex_f</code>)</li>
<li>race/ethnicity (<code>race4</code>)</li>
<li>poverty/income category (<code>povcat_f</code>)</li>
<li>insurance coverage (<code>inscov_f</code>)</li>
<li>multimorbidity (<code>n_ccsr</code>)</li>
</ul>
<p><code>baseline_formula &lt;- high_cost ~ age_cat4 + sex_f + race4 + povcat_f + inscov_f + n_ccsr</code></p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="center">Estimate</th>
<th align="center">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age 18–44</td>
<td align="center">-0.007</td>
<td align="center">0.9765</td>
</tr>
<tr class="even">
<td align="left">Age 45–64</td>
<td align="center">0.678</td>
<td align="center">0.0025**</td>
</tr>
<tr class="odd">
<td align="left">Age 65+</td>
<td align="center">0.480</td>
<td align="center">0.0347*</td>
</tr>
<tr class="even">
<td align="left">Female</td>
<td align="center">-0.214</td>
<td align="center">0.0324*</td>
</tr>
<tr class="odd">
<td align="left">NH Black</td>
<td align="center">0.022</td>
<td align="center">0.8889</td>
</tr>
<tr class="even">
<td align="left">Hispanic</td>
<td align="center">-0.163</td>
<td align="center">0.2220</td>
</tr>
<tr class="odd">
<td align="left">NH Asian/Other</td>
<td align="center">-0.067</td>
<td align="center">0.6910</td>
</tr>
<tr class="even">
<td align="left">Near-poor</td>
<td align="center">-0.060</td>
<td align="center">0.7540</td>
</tr>
<tr class="odd">
<td align="left">Low income</td>
<td align="center">-0.158</td>
<td align="center">0.4738</td>
</tr>
<tr class="even">
<td align="left">Middle income</td>
<td align="center">-0.210</td>
<td align="center">0.1955</td>
</tr>
<tr class="odd">
<td align="left">High income</td>
<td align="center">-0.061</td>
<td align="center">0.7031</td>
</tr>
<tr class="even">
<td align="left">Public only insurance</td>
<td align="center">-0.033</td>
<td align="center">0.7061</td>
</tr>
<tr class="odd">
<td align="left">Uninsured</td>
<td align="center">-0.938</td>
<td align="center">0.0451*</td>
</tr>
<tr class="even">
<td align="left">Number of CCSR categories</td>
<td align="center">0.214</td>
<td align="center">0.0000***</td>
</tr>
</tbody>
</table>
<p>As is shown is the table, individuals <code>aged 45–64</code> and
<code>65+</code> were significantly more likely to be high-cost compared
with the reference age group. <code>Female</code> patients also
exhibited slightly higher odds of being high-cost. Lack of insurance
coverage (<code>Uninsured</code>) was another significant risk factor,
highlighting the vulnerability of those without financial protection.
Finally, the <code>number of CCSR condition categories</code>, our
measure or multimorbidity, was significant and demonstrated the largest
effect size.</p>
<p><br></p>
</div>
<div id="model-2-full-model-including-major-ccsr-condition-indicators"
class="section level3">
<h3>Model 2: Full model including major CCSR condition indicators</h3>
<p>We extended the baseline model by adding binary indicators for the
most common CCSR categories observed in the sample. We first summarized
all condition records using both unweighted frequency counts and
survey-weighted counts.</p>
<p><img src="Report_files/figure-html/unnamed-chunk-11-1.png" width="480" /><img src="Report_files/figure-html/unnamed-chunk-11-2.png" width="480" /></p>
<p>The two rankings were largely consistent, and we selected the union
of the top conditions from both lists to ensure clinically relevant and
high-prevalence categories were included. This process resulted in 11
CCSR binary indicators, each representing whether a person had at least
one condition in that category. Including:</p>
<ul>
<li><strong>CIR007</strong>: Essential hypertension</li>
<li><strong>END010</strong>: Disorders of lipid metabolism</li>
<li><strong>MUS010</strong>: Musculoskeletal pain<br />
</li>
<li><strong>END002</strong>: Diabetes mellitus without complication</li>
<li><strong>MBD005</strong>: Anxiety and fear-related disorders<br />
</li>
<li><strong>MBD002</strong>: Depressive disorder<br />
</li>
<li><strong>END001</strong>: Thyroid disorders</li>
<li><strong>MUS006</strong>: Osteoarthritis</li>
<li><strong>DIG004</strong>: Esophageal disorders<br />
</li>
<li><strong>RSP009</strong>: Asthma</li>
<li><strong>INJ031</strong>: Allergic reactions</li>
</ul>
<p><code>full_formula &lt;- high_cost ~ age_cat4 + sex_f + race4 + povcat_f + inscov_f + n_ccsr</code></p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="center">Estimate</th>
<th align="center">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age 18–44</td>
<td align="center">0.102</td>
<td align="center">0.6709</td>
</tr>
<tr class="even">
<td align="left">Age 45–64</td>
<td align="center">0.832</td>
<td align="center">2e-04***</td>
</tr>
<tr class="odd">
<td align="left">Age 65+</td>
<td align="center">0.594</td>
<td align="center">0.0113*</td>
</tr>
<tr class="even">
<td align="left">Female</td>
<td align="center">-0.157</td>
<td align="center">0.1529</td>
</tr>
<tr class="odd">
<td align="left">NH Black</td>
<td align="center">-0.043</td>
<td align="center">0.7984</td>
</tr>
<tr class="even">
<td align="left">Hispanic</td>
<td align="center">-0.225</td>
<td align="center">0.1002</td>
</tr>
<tr class="odd">
<td align="left">NH Asian/Other</td>
<td align="center">-0.093</td>
<td align="center">0.5901</td>
</tr>
<tr class="even">
<td align="left">Near-poor</td>
<td align="center">-0.079</td>
<td align="center">0.6924</td>
</tr>
<tr class="odd">
<td align="left">Low income</td>
<td align="center">-0.149</td>
<td align="center">0.501</td>
</tr>
<tr class="even">
<td align="left">Middle income</td>
<td align="center">-0.232</td>
<td align="center">0.1486</td>
</tr>
<tr class="odd">
<td align="left">High income</td>
<td align="center">-0.088</td>
<td align="center">0.5782</td>
</tr>
<tr class="even">
<td align="left">Public only insurance</td>
<td align="center">-0.021</td>
<td align="center">0.8096</td>
</tr>
<tr class="odd">
<td align="left">Uninsured</td>
<td align="center">-0.949</td>
<td align="center">0.0422*</td>
</tr>
<tr class="even">
<td align="left">Number of CCSR categories</td>
<td align="center">0.266</td>
<td align="center">0***</td>
</tr>
<tr class="odd">
<td align="left">Essential hypertension</td>
<td align="center">-0.194</td>
<td align="center">0.1088</td>
</tr>
<tr class="even">
<td align="left">Disorders of lipid metabolism</td>
<td align="center">-0.444</td>
<td align="center">2e-04***</td>
</tr>
<tr class="odd">
<td align="left">Musculoskeletal pain</td>
<td align="center">-0.168</td>
<td align="center">0.1024</td>
</tr>
<tr class="even">
<td align="left">Diabetes mellitus (no complication)</td>
<td align="center">0.336</td>
<td align="center">0.001***</td>
</tr>
<tr class="odd">
<td align="left">Anxiety disorders</td>
<td align="center">-0.377</td>
<td align="center">0.0119*</td>
</tr>
<tr class="even">
<td align="left">Depressive disorder</td>
<td align="center">-0.399</td>
<td align="center">0.0074**</td>
</tr>
<tr class="odd">
<td align="left">Thyroid disorders</td>
<td align="center">-0.343</td>
<td align="center">0.0136*</td>
</tr>
<tr class="even">
<td align="left">Osteoarthritis</td>
<td align="center">0.002</td>
<td align="center">0.9865</td>
</tr>
<tr class="odd">
<td align="left">Esophageal disorders</td>
<td align="center">-0.031</td>
<td align="center">0.8243</td>
</tr>
<tr class="even">
<td align="left">Asthma</td>
<td align="center">-0.363</td>
<td align="center">0.0115*</td>
</tr>
<tr class="odd">
<td align="left">Allergic reactions</td>
<td align="center">-0.125</td>
<td align="center">0.4059</td>
</tr>
</tbody>
</table>
<p>In the full model, disorders of lipid metabolism
(<code>END010</code>), diabetes mellitus without complication
(<code>END002</code>), depressive disorder (<code>MBD002</code>),
anxiety disorders (<code>MBD005</code>), thyroid disorders
(<code>END001</code>), and asthma (<code>RSP009</code>) show strong
associations with higher healthcare spending.</p>
<p>Compared with <code>Model 1</code>, <code>Female</code> is no longer
a significant predictors, while others ramain significant.</p>
<p><br></p>
</div>
<div id="model-3-selected-model-with-significant-predictors"
class="section level3">
<h3>Model 3: Selected model with significant predictors</h3>
<p>For <code>Model 3</code>, we only add the predictors that are
significant in <code>Model 1</code> and <code>Model 2</code>, reducing
model complexity.</p>
<p><code>selected_formula &lt;- high_cost ~ age_cat4 + sex_f +  inscov_f + n_ccsr + END010 + END002 + MBD005 + MBD002 + END001 + RSP009</code></p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="center">Estimate</th>
<th align="center">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age 18–44</td>
<td align="center">0.084</td>
<td align="center">0.7273</td>
</tr>
<tr class="even">
<td align="left">Age 45–64</td>
<td align="center">0.785</td>
<td align="center">5e-04***</td>
</tr>
<tr class="odd">
<td align="left">Age 65+</td>
<td align="center">0.544</td>
<td align="center">0.0172*</td>
</tr>
<tr class="even">
<td align="left">Female</td>
<td align="center">-0.155</td>
<td align="center">0.1385</td>
</tr>
<tr class="odd">
<td align="left">Public only insurance</td>
<td align="center">-0.036</td>
<td align="center">0.6861</td>
</tr>
<tr class="even">
<td align="left">Uninsured</td>
<td align="center">-1.022</td>
<td align="center">0.0282*</td>
</tr>
<tr class="odd">
<td align="left">Number of CCSR categories</td>
<td align="center">0.257</td>
<td align="center">0***</td>
</tr>
<tr class="even">
<td align="left">Disorders of lipid metabolism</td>
<td align="center">-0.484</td>
<td align="center">0***</td>
</tr>
<tr class="odd">
<td align="left">Diabetes mellitus (no complication)</td>
<td align="center">0.313</td>
<td align="center">0.0019**</td>
</tr>
<tr class="even">
<td align="left">Anxiety disorders</td>
<td align="center">-0.347</td>
<td align="center">0.0184*</td>
</tr>
<tr class="odd">
<td align="left">Depressive disorder</td>
<td align="center">-0.377</td>
<td align="center">0.0107*</td>
</tr>
<tr class="even">
<td align="left">Thyroid disorders</td>
<td align="center">-0.324</td>
<td align="center">0.0173*</td>
</tr>
<tr class="odd">
<td align="left">Asthma</td>
<td align="center">-0.350</td>
<td align="center">0.015*</td>
</tr>
</tbody>
</table>
</div>
<div id="model-comparison" class="section level3">
<h3>Model Comparison</h3>
<p>We compared the performance of the three fitted models using AIC. A
lower AIC indicates a better trade-off between model fit and
complexity.</p>
<table>
<thead>
<tr class="header">
<th align="center">Model</th>
<th align="center">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Baseline model</td>
<td align="center">4840.25</td>
</tr>
<tr class="even">
<td align="center">Full model</td>
<td align="center">4797.00</td>
</tr>
<tr class="odd">
<td align="center">Selected model</td>
<td align="center">4780.37</td>
</tr>
</tbody>
</table>
<p>Accordingly, the <code>Selected model</code> achieves the lowest AIC
4780.37. This suggests that adding clinically relevant CCSR indicators
improves model fit, and further removing non-significant predictors
yields a more efficient model without sacrificing performance.</p>
<p>To assess the predictive performance across different cohorts, we
next perform repeated K-fold cross-validation on all three models and
compare their RMSE distributions. We chose to repeat 100 times with
K=5.</p>
<p><img src="Report_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Across 100 repeated 5-fold cross-validations, all three models
yielded very similar RMSE values. The selected model achieved the lowest
average RMSE (≈0.2331). Although the improvement is modest, this
suggests that adding a small set of targeted CCSR indicators contributes
slightly better predictive accuracy than including all conditions or
using demographics alone.</p>
<p><br></p>
<p><em>The full, reproducible code used to implement the regression
modeling and cross-validation procedures described above is provided
below. Readers who are primarily interested in results may skip this
section.</em></p>
<details>
<summary>
<strong>Click to show / hide full regression modeling code</strong>
</summary>
<p><br></p>
<pre class="r"><code>## Regression
library(dplyr)
library(ggplot2)
library(tidyr)
library(purrr)
library(survey)

## ---- create multimorbidity (person_ccsr) ----
person_ccsr &lt;- cond23_clean %&gt;% 
  group_by(dupersid) %&gt;% 
  summarise(
    n_ccsr = n_distinct(ccsr_main),   # number of distinct CCSR categories
    .groups = &quot;drop&quot;
  ) %&gt;% 
  mutate(
    multi_morbidity = if_else(n_ccsr &gt;= 3, 1, 0)  # threshold can be customized
  )

## ---- CCSR frequency (unweighted) ----
ccsr_counts &lt;- cond23_clean %&gt;% 
  count(ccsr_main, sort = TRUE)

head(ccsr_counts, 10)</code></pre>
<pre><code>## # A tibble: 10 × 2
##    ccsr_main     n
##    &lt;chr&gt;     &lt;int&gt;
##  1 CIR007     4312
##  2 END010     3626
##  3 MUS010     2557
##  4 END002     1960
##  5 MBD005     1791
##  6 MBD002     1557
##  7 END001     1346
##  8 MUS006     1345
##  9 DIG004     1245
## 10 RSP009     1212</code></pre>
<pre class="r"><code>ccsr_top20 &lt;- ccsr_counts %&gt;% 
  slice_max(n, n = 20)

ggplot(ccsr_top20,
       aes(x = reorder(ccsr_main, n),
           y = n)) +
  geom_col() +
  coord_flip() +
  labs(
    x = &quot;CCSR category&quot;,
    y = &quot;Number of condition records&quot;,
    title = &quot;Top 20 most common CCSR condition categories (unweighted)&quot;
  )</code></pre>
<p><img src="Report_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>## ---- CCSR frequency (weighted) ----
ccsr_w_counts &lt;- cond23_clean %&gt;% 
  group_by(ccsr_main) %&gt;% 
  summarise(
    w_count = sum(perwt23f, na.rm = TRUE),
    .groups = &quot;drop&quot;
  ) %&gt;% 
  arrange(desc(w_count))

ccsr_w_top20 &lt;- ccsr_w_counts %&gt;% 
  slice_max(w_count, n = 20)

ggplot(ccsr_w_top20,
       aes(x = reorder(ccsr_main, w_count),
           y = w_count)) +
  geom_col() +
  coord_flip() +
  labs(
    x = &quot;CCSR category&quot;,
    y = &quot;Weighted count of conditions&quot;,
    title = &quot;Top 20 CCSR condition categories (weighted by PERWT23F)&quot;
  )</code></pre>
<p><img src="Report_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<pre class="r"><code>## ---- compare top10 CCSR: unweighted vs weighted ----
data.frame(
  unweighted_top10 = ccsr_counts$ccsr_main[1:10],
  weighted_top10   = ccsr_w_counts$ccsr_main[1:10]
)</code></pre>
<pre><code>##    unweighted_top10 weighted_top10
## 1            CIR007         CIR007
## 2            END010         END010
## 3            MUS010         MUS010
## 4            END002         MBD005
## 5            MBD005         END002
## 6            MBD002         MBD002
## 7            END001         END001
## 8            MUS006         RSP009
## 9            DIG004         INJ031
## 10           RSP009         MUS006</code></pre>
<pre class="r"><code>ccsr_union &lt;- union(
  ccsr_counts$ccsr_main[1:10],
  ccsr_w_counts$ccsr_main[1:10]
)
ccsr_union</code></pre>
<pre><code>##  [1] &quot;CIR007&quot; &quot;END010&quot; &quot;MUS010&quot; &quot;END002&quot; &quot;MBD005&quot; &quot;MBD002&quot; &quot;END001&quot; &quot;MUS006&quot;
##  [9] &quot;DIG004&quot; &quot;RSP009&quot; &quot;INJ031&quot;</code></pre>
<pre class="r"><code>## ---- create binary disease indicators in person_ccsr ----
for (disease in ccsr_union) {
  var_name &lt;- disease
  person_ccsr[[var_name]] &lt;- ifelse(
    person_ccsr$dupersid %in% cond23_clean$dupersid[cond23_clean$ccsr_main == disease],
    1, 
    0
  )
}

## ---- merge to FYC file and define high_cost ----
fyc23_model &lt;- fyc23_clean %&gt;%
  left_join(person_ccsr, by = &quot;dupersid&quot;) %&gt;% 
  mutate(
    high_cost = ifelse(exp_group == &quot;Top 5%&quot;, 1, 0)    # outcome: in top 5% vs others
  )

## ---- survey design object ----
des_model &lt;- svydesign(
  ids     = ~varpsu,
  strata  = ~varstr,
  weights = ~perwt23f,
  data    = fyc23_model,
  nest    = TRUE
)

## ---- baseline model ----
baseline_formula &lt;- high_cost ~ 
  age_cat4 + sex_f + race4 + povcat_f + inscov_f + n_ccsr

model_baseline &lt;- svyglm(
  baseline_formula,
  design = des_model,
  family = quasibinomial()
)
summary(model_baseline)</code></pre>
<pre><code>## 
## Call:
## svyglm(formula = baseline_formula, design = des_model, family = quasibinomial())
## 
## Survey design:
## svydesign(ids = ~varpsu, strata = ~varstr, weights = ~perwt23f, 
##     data = fyc23_model, nest = TRUE)
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -4.104708   0.227373 -18.053  &lt; 2e-16 ***
## age_cat418-44         -0.007022   0.237934  -0.030  0.97650    
## age_cat445-64          0.677880   0.220487   3.074  0.00253 ** 
## age_cat465+            0.480386   0.225351   2.132  0.03474 *  
## sex_fFemale           -0.213897   0.098997  -2.161  0.03239 *  
## race4NH Black          0.022008   0.157238   0.140  0.88888    
## race4Hispanic         -0.163021   0.132912  -1.227  0.22201    
## race4NH Asian/Other   -0.067057   0.168351  -0.398  0.69099    
## povcat_fNear-poor     -0.060137   0.191515  -0.314  0.75397    
## povcat_fLow income    -0.157595   0.219433  -0.718  0.47381    
## povcat_fMiddle income -0.210476   0.161846  -1.300  0.19553    
## povcat_fHigh income   -0.061194   0.160228  -0.382  0.70309    
## inscov_fPublic only   -0.032550   0.086140  -0.378  0.70609    
## inscov_fUninsured     -0.937976   0.464114  -2.021  0.04515 *  
## n_ccsr                 0.214228   0.011780  18.185  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasibinomial family taken to be 0.8830159)
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>## ---- full model with top CCSR indicators ----
ccsr_vars &lt;- c(
  &quot;CIR007&quot;,&quot;END010&quot;,&quot;MUS010&quot;,&quot;END002&quot;,&quot;MBD005&quot;,
  &quot;MBD002&quot;,&quot;END001&quot;,&quot;MUS006&quot;,&quot;DIG004&quot;,&quot;RSP009&quot;,&quot;INJ031&quot;
)

full_formula &lt;- update(
  baseline_formula,
  paste(&quot;. ~ . +&quot;, paste(ccsr_vars, collapse = &quot; + &quot;))
)

model_full &lt;- svyglm(
  full_formula,
  design = des_model,
  family = quasibinomial()
)
summary(model_full)</code></pre>
<pre><code>## 
## Call:
## svyglm(formula = full_formula, design = des_model, family = quasibinomial())
## 
## Survey design:
## svydesign(ids = ~varpsu, strata = ~varstr, weights = ~perwt23f, 
##     data = fyc23_model, nest = TRUE)
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -4.142628   0.228470 -18.132  &lt; 2e-16 ***
## age_cat418-44          0.102474   0.240611   0.426 0.670882    
## age_cat445-64          0.831983   0.217967   3.817 0.000207 ***
## age_cat465+            0.594221   0.231250   2.570 0.011292 *  
## sex_fFemale           -0.156823   0.109086  -1.438 0.152913    
## race4NH Black         -0.042759   0.167079  -0.256 0.798411    
## race4Hispanic         -0.224776   0.135783  -1.655 0.100218    
## race4NH Asian/Other   -0.093139   0.172478  -0.540 0.590104    
## povcat_fNear-poor     -0.078894   0.199010  -0.396 0.692427    
## povcat_fLow income    -0.148990   0.220808  -0.675 0.501016    
## povcat_fMiddle income -0.232388   0.159920  -1.453 0.148556    
## povcat_fHigh income   -0.088322   0.158463  -0.557 0.578221    
## inscov_fPublic only   -0.021281   0.088128  -0.241 0.809563    
## inscov_fUninsured     -0.948724   0.462411  -2.052 0.042177 *  
## n_ccsr                 0.266333   0.015616  17.056  &lt; 2e-16 ***
## CIR007                -0.194120   0.120247  -1.614 0.108842    
## END010                -0.443579   0.116416  -3.810 0.000212 ***
## MUS010                -0.167892   0.102078  -1.645 0.102402    
## END002                 0.335854   0.099413   3.378 0.000959 ***
## MBD005                -0.377359   0.147979  -2.550 0.011912 *  
## MBD002                -0.398973   0.146619  -2.721 0.007383 ** 
## END001                -0.342818   0.137000  -2.502 0.013559 *  
## MUS006                 0.002394   0.141474   0.017 0.986525    
## DIG004                -0.031370   0.141049  -0.222 0.824340    
## RSP009                -0.363132   0.141636  -2.564 0.011472 *  
## INJ031                -0.125316   0.150305  -0.834 0.405932    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasibinomial family taken to be 0.8593806)
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>## ---- selected model (significant variables) ----
selected_vars &lt;- c(
  &quot;age_cat4&quot;,
  &quot;sex_f&quot;,
  &quot;inscov_f&quot;,
  &quot;n_ccsr&quot;,
  &quot;END010&quot;,&quot;END002&quot;,&quot;MBD005&quot;,&quot;MBD002&quot;,&quot;END001&quot;,&quot;RSP009&quot;
)

full_formula2 &lt;- as.formula(
  paste(&quot;high_cost ~&quot;, paste(selected_vars, collapse = &quot; + &quot;))
)

model_selected &lt;- svyglm(
  full_formula2,
  design = des_model,
  family = quasibinomial()
)
summary(model_selected)</code></pre>
<pre><code>## 
## Call:
## svyglm(formula = full_formula2, design = des_model, family = quasibinomial())
## 
## Survey design:
## svydesign(ids = ~varpsu, strata = ~varstr, weights = ~perwt23f, 
##     data = fyc23_model, nest = TRUE)
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -4.31773    0.20571 -20.989  &lt; 2e-16 ***
## age_cat418-44        0.08445    0.24168   0.349 0.727272    
## age_cat445-64        0.78462    0.22112   3.548 0.000524 ***
## age_cat465+          0.54424    0.22584   2.410 0.017221 *  
## sex_fFemale         -0.15467    0.10382  -1.490 0.138489    
## inscov_fPublic only -0.03556    0.08779  -0.405 0.686059    
## inscov_fUninsured   -1.02154    0.46093  -2.216 0.028245 *  
## n_ccsr               0.25654    0.01327  19.329  &lt; 2e-16 ***
## END010              -0.48358    0.11477  -4.214 4.41e-05 ***
## END002               0.31291    0.09915   3.156 0.001949 ** 
## MBD005              -0.34744    0.14565  -2.385 0.018365 *  
## MBD002              -0.37714    0.14576  -2.587 0.010662 *  
## END001              -0.32440    0.13471  -2.408 0.017301 *  
## RSP009              -0.34996    0.14209  -2.463 0.014956 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasibinomial family taken to be 0.8704885)
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>## ---- compare AIC ----
AIC(model_baseline)</code></pre>
<pre><code>##       eff.p         AIC    deltabar 
##   17.758600 4840.253423    1.268471</code></pre>
<pre class="r"><code>AIC(model_full)</code></pre>
<pre><code>##       eff.p         AIC    deltabar 
##   31.453566 4796.998920    1.258143</code></pre>
<pre class="r"><code>AIC(model_selected)</code></pre>
<pre><code>##       eff.p         AIC    deltabar 
##   16.489108 4780.365412    1.268393</code></pre>
<pre class="r"><code>## ---- CV helper function (simple glm, no survey weights) ----
cv_rmse &lt;- function(formula, data, K = 5) {
  n &lt;- nrow(data)
  folds &lt;- sample(rep(1:K, length.out = n))
  
  rmse_vec &lt;- numeric(K)
  
  for (k in 1:K) {
    train &lt;- data[folds != k, ]
    test  &lt;- data[folds == k, ]
    
    fit &lt;- glm(formula, data = train, family = binomial())
    
    p_hat &lt;- predict(fit, newdata = test, type = &quot;response&quot;)
    rmse_vec[k] &lt;- sqrt(mean((p_hat - test$high_cost)^2))
  }
  
  rmse_vec
}

## ---- prepare data for CV ----
set.seed(1234)
n_rep &lt;- 100
K &lt;- 5

df_cv &lt;- fyc23_model %&gt;%
  select(
    high_cost,
    age_cat4, sex_f, race4, povcat_f, inscov_f, n_ccsr,
    CIR007, END010, MUS010, END002, MBD005, MBD002, END001, MUS006, DIG004, RSP009, INJ031
  ) %&gt;%
  drop_na() %&gt;%                            
  mutate(
    high_cost = as.numeric(high_cost)
  )

## ---- run CV for three models ----
cv_results &lt;- map_dfr(1:n_rep, ~{
  tibble(
    model = &quot;Baseline&quot;,
    rmse  = cv_rmse(baseline_formula, df_cv, K = K)
  ) %&gt;%
    bind_rows(
      tibble(
        model = &quot;Full&quot;,
        rmse  = cv_rmse(full_formula, df_cv, K = K)
      ),
      tibble(
        model = &quot;Selected&quot;,
        rmse  = cv_rmse(full_formula2, df_cv, K = K)
      )
    )
})

## ---- summarise CV results ----
cv_summary &lt;- cv_results %&gt;%
  group_by(model) %&gt;%
  summarise(mean_rmse = mean(rmse)) %&gt;%
  arrange(model)

cv_summary</code></pre>
<pre><code>## # A tibble: 3 × 2
##   model    mean_rmse
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 Baseline     0.234
## 2 Full         0.234
## 3 Selected     0.233</code></pre>
<pre class="r"><code>## ---- plot CV RMSE ----
ggplot(cv_results, aes(x = model, y = rmse)) +
  geom_violin(trim = FALSE, fill = NA, color = &quot;lightblue&quot;) +
  geom_boxplot(width = 0.15, fill = &quot;white&quot;, outlier.size = 0.5) +
  labs(
    x = NULL,
    y = &quot;Cross-validated RMSE&quot;,
    title = &quot;Cross-validated prediction error for three models&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="Report_files/figure-html/unnamed-chunk-20-3.png" width="672" /></p>
</details>
<hr />
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>Our findings indicate that a parsimonious set of demographic and
clinical predictors can meaningfully distinguish high cost patients in
the 2023 MEPS sample. The final model incorporates age, insurance
status, multimorbidity burden, and six key CCSR based condition
indicators, suggesting that a relatively small and interpretable set of
health and socioeconomic characteristics is sufficient to capture much
of the observable contrast between high and lower cost individuals.
Although overall predictive performance is modest, which is typical for
rare and highly variable cost outcomes in population based survey data,
the model nonetheless provides actionable signal that may support
earlier identification of high cost patients and inform the design and
targeting of care management or cost containment interventions in value
based care settings.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
